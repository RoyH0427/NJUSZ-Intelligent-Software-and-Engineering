# ç¬¬ä¸‰ç«  çº¿æ€§æ¨¡å‹

## 3.1 åŸºæœ¬å½¢å¼

çº¿æ€§æ¨¡å‹è¯•å›¾å­¦å¾—ä¸€ä¸ªé€šè¿‡å±æ€§çš„çº¿æ€§ç»„åˆæ¥è¿›è¡Œé¢„æµ‹çš„å‡½æ•°
$$
f(x)=w_1x_1+w_2x_2+\ldots+w_dx_d+b
$$
$x=(x_1,x_2,...,x_d)$ æ˜¯ç”±å±æ€§æè¿°çš„ç¤ºä¾‹ï¼Œå…¶ä¸­ $x_i$ æ˜¯ $x$ åœ¨ç¬¬ $i$ ä¸ªå±æ€§ä¸Šçš„å–å€¼

å‘é‡å½¢å¼ï¼š$f( x) = w^\text{T}x+ b$ï¼Œ$w= ( w_1, w_2, . . . , w_d)$

 ## 3.2 çº¿æ€§å›å½’

ç»™å®šæ•°æ®é›† $D=\{(x_1,y_1),(x_2,y_2),...,(x_m,y_m)\}$ï¼Œå…¶ä¸­ $x_i=(x_{i1};x_{i2};...;x_{id}),y_i\in\mathbb{R}$

çº¿æ€§å›å½’çš„ç›®çš„ï¼šå­¦å¾—ä¸€ä¸ªçº¿æ€§æ¨¡å‹ä»¥å°½å¯èƒ½å‡†ç¡®åœ°é¢„æµ‹å®å€¼è¾“å‡ºæ ‡è®°ã€‚

å•ä¸€å±æ€§çš„çº¿æ€§å›å½’ç›®æ ‡ï¼š$f(x_i)=wx_i+b$ï¼Œä½¿å¾— $f(x_i)\simeq y_i $

å‚æ•°/æ¨¡å‹ä¼°è®¡ï¼š**æœ€å°äºŒä¹˜æ³•**

ä»¤å‡æ–¹è¯¯å·®æœ€å°åŒ–ï¼Œæœ‰
$$
\begin{aligned}
(w^*,b^*)& =\arg\min_{(w,b)}\sum_{i=1}^{m}\left(f\left(x_{i}\right)-y_{i}\right)^{2} \\
&=\arg\min_{(w,b)}\sum_{i=1}^m(y_i-wx_i-b)^2
\end{aligned}
$$
æ±‚è§£ $w$ å’Œ $b$ ä½¿ $E_(w,b)=\sum_{i=1}^m(y_i-wx_i-b)^2$ æœ€å°åŒ–çš„è¿‡ç¨‹ï¼Œç§°ä¸ºçº¿æ€§å›å½’æ¨¡å‹çš„æœ€å°äºŒä¹˜â€œå‚æ•°ä¼°è®¡â€ã€‚æˆ‘ä»¬å¯å°† $E_{(w,b)}$ åˆ†åˆ«å¯¹ $w$ å’Œ $b$ æ±‚å¯¼ï¼Œå¾—åˆ°ï¼š
$$
\begin{aligned}
\frac{\partial E_{(w,b)}}{\partial w}&=2\left(w\sum_{i=1}^mx_i^2-\sum_{i=1}^m\left(y_i-b\right)x_i\right) \\
\frac{\partial E_{(w,b)}}{\partial b}&=2\left(mb-\sum_{i=1}^m\left(y_i-wx_i\right)\right)
\end{aligned}
$$
ä»¤å¯¼æ•°ä¸º 0ï¼Œå¾—åˆ°é—­å¼è§£
$$
\begin{align*}
w=\frac{\sum_{i=1}^m y_i(x_i-\bar{x})}{\sum_{i=1}^mx_i^2\frac{1}{m}\left(\sum_{i=1}^mx_i\right)^2} \\

b=\frac{1}{m}\sum_{i=1}^m(y_i-wx_i)
\end{align*}
$$
å…¶ä¸­ $\bar{x}=\frac1m\sum_{i=1}^mx_i$ ä¸º x çš„å‡å€¼



### å¤šå…ƒçº¿æ€§å›å½’

å¤šå…ƒçº¿æ€§å›å½’ç›®æ ‡ï¼š$f(x_i)=w^\mathrm{T} x_i+b$ï¼Œä½¿å¾— $f(x_i)\simeq y_i $

æŠŠ $w$ å’Œ $b$ å¸æ”¶å…¥å‘é‡å½¢å¼ $\widehat{w}=(w,b)$ï¼Œæ•°æ®é›†è¡¨ç¤ºä¸º
$$
\mathbf{X}=\begin{pmatrix}x_{11}&x_{12}&\cdots&x_{1d}&1\\x_{21}&x_{22}&\cdots&x_{2d}&1\\\vdots&\vdots&\ddots&\vdots&\vdots\\x_{m1}&x_{m2}&\cdots&x_{md}&1\end{pmatrix}=\begin{pmatrix}\boldsymbol{x}_1^\mathrm{T}&1\\\boldsymbol{x}_2^\mathrm{T}&1\\\vdots&\vdots\\\boldsymbol{x}_m^\mathrm{T}&1\end{pmatrix}\:\boldsymbol{y}=(y_1;y_2;\ldots;y_m)
$$
$\hat{\boldsymbol{w}}^*=\arg\min_{\hat{w}}\left(\boldsymbol{y}-\mathbf{X}\hat{\boldsymbol{w}}\right)^\mathrm{T}\left(\boldsymbol{y}-\mathbf{X}\hat{\boldsymbol{w}}\right)$

ä»¤ $E_{\hat{w}}=\left(\boldsymbol{y}-\mathbf{X}\hat{\boldsymbol{w}}\right)^\mathrm{T}\left(\boldsymbol{y}-\mathbf{X}\hat{\boldsymbol{w}}\right)$ï¼Œå¯¹ $\hat{\boldsymbol{w}}$ æ±‚å¯¼å¾—åˆ° $\frac{\partial E_{\hat{\boldsymbol{w}}}}{\partial\hat{\boldsymbol{w}}}=2\mathbf{X}^\mathrm{T}\left(\mathbf{X}\hat{\boldsymbol{w}}-\boldsymbol{y}\right)$

ä»¤ä¸Šå¼ä¸ºé›¶å¯å¾— $\hat{\boldsymbol{w}}$ æœ€ä¼˜è§£çš„é—­å¼è§£

- $\mathbf{X}^{\mathrm{T}}\mathbf{X}$ æ˜¯æ»¡ç§©çŸ©é˜µæˆ–æ­£å®šçŸ©é˜µï¼Œåˆ™ $\hat{\boldsymbol{w}}^{*}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\boldsymbol{y}$

  å…¶ä¸­ $(\mathbf{X}^{\mathrm{T}}\mathbf{X})^{-1}$ æ˜¯ $\mathbf{X}^{\mathrm{T}}\mathbf{X}$ çš„é€†çŸ©é˜µï¼Œçº¿æ€§å›å½’æ¨¡å‹ä¸º $f\left(\hat{\boldsymbol{x}}_i\right)=\hat{\boldsymbol{x}}_i^\mathrm{T}\left(\mathbf{X}^\mathrm{T}\mathbf{X}\right)^{-1}\mathbf{X}^\mathrm{T}y$

- $\mathbf{X}^{\mathrm{T}}\mathbf{X}$ ä¸æ˜¯æ»¡ç§©çŸ©é˜µï¼Œåˆ™å¯è§£å‡ºå¤šä¸ª $\hat{\boldsymbol{w}}$
  - æ ¹æ®å½’çº³åå¥½é€‰æ‹©è§£ï¼ˆ1.4ï¼‰
  - å¼•å…¥æ­£åˆ™åŒ–ï¼ˆ6.4ï¼Œ11.4ï¼‰

è‹¥ä»¤ $\ln y=w^\mathrm{T}x+b$ï¼Œåˆ™å¾—åˆ°å¯¹æ•°çº¿æ€§å›å½’ã€‚å®é™…æ˜¯åœ¨ç”¨ $e^{w^\mathrm{T}x+b}$ é€¼è¿‘ y

å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼šè€ƒè™‘å•è°ƒå¯å¾®çš„**è”ç³»å‡½æ•°** $g(Â·)$ï¼Œ$y=g^{-1}\left(w^\mathrm{T}x+b\right)$

ï¼ˆå¯¹æ•°çº¿æ€§å›å½’æ˜¯å¹¿ä¹‰çº¿æ€§æ¨¡å‹çš„ç‰¹ä¾‹ï¼‰

## 3.3 å¯¹æ•°å‡ ç‡å›å½’

çº¿æ€§å›å½’æ¨¡å‹äº§ç”Ÿçš„å®å€¼è¾“å‡º $z=\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b$ï¼ŒæœŸæœ›è¾“å‡º $y \in \{0, 1\}$

éœ€è¦æ‰¾ z å’Œ y çš„è”ç³»å‡½æ•°

ç†æƒ³çš„â€œå•ä½é˜¶è·ƒå‡½æ•°â€ï¼šå¸¸ç”¨ã€å•è°ƒå¯å¾®ã€ä»»æ„é˜¶å¯å¯¼
$$
y=\begin{cases}&0,&z<0;\\&0.5,&z=0;\\&1,&z>0,&\end{cases}
$$
è‹¥é¢„æµ‹å€¼ z å¤§äº 0 åˆ™åˆ¤ä¸ºæ­£ä¾‹ï¼Œå°äº 0 åä¾‹ï¼Œ0 å¯ä»¥ä»»æ„åˆ¤åˆ«

ç†æƒ³å‡½æ•°ä¸è¿ç»­ï¼Œéœ€è¦æ‰¾åˆ°æ›¿ä»£ï¼šå¯¹æ•°å‡ ç‡å‡½æ•°ï¼š
$$
y=\frac{1}{1+e^{-z}}
$$
![image-20241211140624040](3çº¿æ€§æ¨¡å‹.assets/image-20241211140624040.png)

ä»¥å¯¹ç‡å‡½æ•°ä¸ºè”ç³»å‡½æ•°ï¼š$y=\frac{1}{1+e^{-z}}$ å˜ä¸º $y=\frac{1}{1+e^{-(\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b)}}$

å³ï¼š$\ln\frac{y}{1-y}=\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b$

è‹¥å°† y è§†ä¸ºæ ·æœ¬ x ä½œä¸ºæ­£ä¾‹çš„å¯èƒ½æ€§ï¼Œåˆ™ 1-y æ˜¯å…¶åä¾‹å¯èƒ½æ€§ï¼Œä¸¤è€…çš„æ¯”å€¼ $\frac{y}{1-y}$ ç§°ä¸º**å‡ ç‡**ï¼Œåæ˜ äº† x ä½œä¸ºæ­£ä¾‹çš„ç›¸å¯¹å¯èƒ½æ€§ï¼Œ**å¯¹æ•°å‡ ç‡**ï¼š$\ln \frac{y}{1-y}$

å¯¹æ•°å‡ ç‡å›å½’ï¼šæ— éœ€äº‹å…ˆå‡è®¾æ•°æ®åˆ†å¸ƒï¼›å¯å¾—åˆ°â€œç±»åˆ«â€çš„è¿‘ä¼¼æ¦‚ç‡é¢„æµ‹ï¼›å¯ç›´æ¥åº”ç”¨ç°æœ‰æ•°å€¼ä¼˜åŒ–ç®—æ³•æ±‚å–æœ€ä¼˜è§£

### æå¤§ä¼¼ç„¶æ³•

è‹¥å°† y çœ‹ä½œç±»åéªŒæ¦‚ç‡ä¼°è®¡ $p\left(y=1\mid x\right)$ ï¼Œåˆ™ï¼š
$$
\ln\frac{y}{1-y}=w^\mathrm{T}x+b \Rightarrow \mathrm{ln}\frac{p\left(y=1\mid\boldsymbol{x}\right)}{p\left(y=0\mid\boldsymbol{x}\right)}=\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b
$$
å› æ­¤ï¼š
$$
p(y=1\mid\boldsymbol{x})=\frac{e^{\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b}}{1+e^{\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b}}\\
p(y=0\mid\boldsymbol{x})=\frac{1}{1+e^{\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b}}
$$
ç”¨æå¤§ä¼¼ç„¶æ³•ä¼°è®¡ $\boldsymbol{w}$ å’Œ bï¼Œç»™å®šæ•°æ®é›† $\{(\boldsymbol{x}_i,y_i)\}_{i=1}^m$ï¼Œæœ€å¤§å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š
$$
\ell(\boldsymbol{w},b)=\sum_{i=1}^m\ln p(y_i\mid\boldsymbol{x}_i;\boldsymbol{w},b)
$$
å³ä»¤æ¯ä¸ªæ ·æœ¬å±äºå…¶çœŸå®æ ‡è®°çš„æ¦‚ç‡è¶Šå¤§è¶Šå¥½

è½¬åŒ–ä¸ºæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°æ±‚è§£ï¼š

ä»¤ $\boldsymbol{\beta}=(\boldsymbol{w};b)$ ,$\hat{x}=(\boldsymbol{x};1)$ï¼Œåˆ™ $\boldsymbol w^\mathrm{T}x+b$ å¯ç®€å†™ä¸º $\beta^\mathrm{T}\hat{x}$

å†ä»¤  $p_1\left ( \hat{\boldsymbol{x}} _i; \boldsymbol{\beta }\right ) = p\left ( y= 1\mid \hat{\boldsymbol{x}} ; \boldsymbol{\beta }\right ) = \frac {e^{\boldsymbol{w}^\mathrm{T} x+ b}}{1+ e^{\boldsymbol{w}^\mathrm{T} x+ b}}$ï¼Œ$p_{0}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)=p\left(y=0\mid\hat{\boldsymbol{x}};\boldsymbol{\beta}\right)=1-p_{1}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)=\frac{1}{1+e^{\boldsymbol{w}^\mathrm{T}\boldsymbol{x}+b}}$

åˆ™ä¼¼ç„¶é¡¹å¯é‡å†™ä¸º $p\left(y_{i}\mid\boldsymbol{x}_{i};\boldsymbol{w}_{i},b\right)=y_{i}p_{1}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)+\left(1-y_{i}\right)p_{0}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)$

äºæ˜¯ï¼Œæœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ç­‰ä»·å½¢å¼ä¸ºæœ€å°åŒ–ï¼š
$$
\ell\left(\boldsymbol{\beta}\right)=\sum_{i=1}^{m}\left(-y_{i}\boldsymbol{\beta}^{\mathrm{T}}\hat{\boldsymbol{x}}_{i}+\ln\left(1+e^{\beta^{\mathrm{T}}\hat{\boldsymbol{x}}_{i}}\right)\right)
$$
æ±‚è§£å¾—ï¼š$\boldsymbol{\beta}^{*}=\arg\min_{\boldsymbol{\beta}}\ell\left(\boldsymbol{\beta}\right)$

ç‰›é¡¿æ³•ç¬¬ t+1 è½®è¿­ä»£è§£çš„æ›´æ–°å…¬å¼ï¼ˆé«˜é˜¶å¯å¯¼è¿ç»­å‡¸å‡½æ•°ï¼Œæ¢¯åº¦ä¸‹é™æ³•/ç‰›é¡¿æ³•ï¼‰
$$
\boldsymbol{\beta}^{t+1}=\boldsymbol{\beta}^t-\left(\frac{\partial^2\ell\left(\boldsymbol{\beta}\right)}{\partial\boldsymbol{\beta}\partial\boldsymbol{\beta}^\mathrm{T}}\right)^{-1}\frac{\partial\ell\left(\boldsymbol{\beta}\right)}{\partial\boldsymbol{\beta}}
$$
å…¶ä¸­å…³äº ğ›½ çš„ä¸€é˜¶ã€äºŒé˜¶å¯¼æ•°åˆ†åˆ«ä¸º
$$
\frac{\partial\ell\left(\boldsymbol{\beta}\right)}{\partial\boldsymbol{\beta}}=-\sum_{i=1}^{m}\hat{\boldsymbol{x}}_{i}\left(y_{i}-p_{1}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)\right) \\
\frac{\partial^{2}\left(\boldsymbol{\beta}\right)}{\partial\boldsymbol{\beta}\partial\boldsymbol{\beta}^{\mathrm{T}}}=\sum_{i=1}^{m}\hat{\boldsymbol{x}}_{i}\hat{\boldsymbol{x}}_{i}^{\mathrm{T}}p_{1}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)\left(1-p_{1}\left(\hat{\boldsymbol{x}}_{i};\boldsymbol{\beta}\right)\right)
$$

## 3.4 çº¿æ€§åˆ¤åˆ«åˆ†æ

çº¿æ€§åˆ¤åˆ«åˆ†æï¼ˆLDAï¼‰ï¼šç»™å®šè®­ç»ƒæ ·ä¾‹é›†ï¼Œè®¾æ³•å°†æ ·ä¾‹æŠ•å½±åˆ°ä¸€æ¡ç›´çº¿ä¸Šï¼Œä½¿å¾—åŒç±»æ ·ä¾‹çš„æŠ•å½±ç‚¹å°½å¯èƒ½æ¥è¿‘ã€å¼‚ç±»æ ·ä¾‹çš„æŠ•å½±ç‚¹å°½å¯èƒ½è¿œç¦»ï¼›åœ¨å¯¹æ–°æ ·æœ¬è¿›è¡Œåˆ†ç±»æ—¶ï¼Œå°†å…¶æŠ•å½±åˆ°åŒæ ·çš„è¿™æ¡ç›´çº¿ä¸Šï¼Œå†æ ¹æ®æŠ•å½±ç‚¹çš„ä½ç½®æ¥ç¡®å®šæ–°æ ·æœ¬çš„ç±»åˆ«

ç”±äºå°†æ ·ä¾‹æŠ•å½±åˆ°ä¸€æ¡ç›´çº¿ï¼ˆä½ç»´ç©ºé—´ï¼‰ï¼Œå› æ­¤ä¹Ÿè¢«è§†ä¸ºä¸€ç§â€œç›‘ç£é™ç»´â€æŠ€æœ¯ 

<img src="3çº¿æ€§æ¨¡å‹.assets/image-20241211142015936.png" alt="image-20241211142015936" style="zoom: 67%;" />

ç»™å®šæ•°æ®é›† $\left \{ ( \boldsymbol{x}_i, y_i) \right \} _{i= 1}^m$ï¼Œ

ç¬¬ $i$ ç±»ç¤ºä¾‹çš„é›†åˆ $X_i$ï¼Œç¬¬ $i$ ç±»ç¤ºä¾‹çš„å‡å€¼å‘é‡ $\mu_i$ï¼Œç¬¬ $i$ ç±»ç¤ºä¾‹çš„åæ–¹å·®çŸ©é˜µ $\Sigma_i$

ä¸¤ç±»æ ·æœ¬çš„ä¸­å¿ƒåœ¨ç›´çº¿ä¸Šçš„æŠ•å½±ï¼š$\boldsymbol w^\mathrm{T}\boldsymbol{\mu}_0$å’Œ$\boldsymbol w^\mathrm{T}\boldsymbol{\mu}_1$ï¼Œä¸¤ç±»æ ·æœ¬çš„åæ–¹å·®ï¼š$w^\mathrm{T} \Sigma _0\boldsymbol{w}$å’Œ$w^\mathrm{T}\Sigma_1\boldsymbol{w}$

åŒç±»æ ·ä¾‹çš„æŠ•å½±ç‚¹å°½å¯èƒ½æ¥è¿‘$\to$ $w^\mathrm{T} \Sigma _0w+ w^\mathrm{T} \Sigma _1w$å°½å¯èƒ½å°

å¼‚ç±»æ ·ä¾‹çš„æŠ•å½±ç‚¹å°½å¯èƒ½è¿œç¦» $\to$ $\| w^\mathrm{T} \mu _0- w^\mathrm{T} \mu _1\| _2^2$ å°½å¯èƒ½å¤§

äºæ˜¯ï¼Œæœ€å¤§åŒ–
$$
J=\frac{\left\|\boldsymbol{w}^\mathrm{T}\boldsymbol{\mu}_0-\boldsymbol{w}^\mathrm{T}\boldsymbol{\mu}_1\right\|_2^2}{\boldsymbol{w}^\mathrm{T}\boldsymbol{\Sigma}_0\boldsymbol{w}+\boldsymbol{w}^\mathrm{T}\boldsymbol{\Sigma}_1\boldsymbol{w}}=\frac{\boldsymbol{w}^\mathrm{T}\left(\boldsymbol{\mu}_0-\boldsymbol{\mu}_1\right)\left(\boldsymbol{\mu}_0-\boldsymbol{\mu}_1\right)^\mathrm{T}\boldsymbol{w}}{\boldsymbol{w}^\mathrm{T}\left(\boldsymbol{\Sigma}_0+\boldsymbol{\Sigma}_1\right)\boldsymbol{w}}
$$
å®šä¹‰ç±»å†…æ•£åº¦çŸ©é˜µ 
$$
\begin{aligned}\mathbf{S}_{w}&=\Sigma_0+\Sigma_1\\&=\sum_{x\in X_{0}}\left(\boldsymbol{x}-\boldsymbol{\mu}_{0}\right)\left(\boldsymbol{x}-\boldsymbol{\mu}_{0}\right)^{\mathrm{T}}+\sum_{x\in X_{1}}\left(\boldsymbol{x}-\boldsymbol{\mu}_{1}\right)\left(\boldsymbol{x}-\boldsymbol{\mu}_{1}\right)^{\mathrm{T}}\end{aligned}
$$
ç±»é—´æ•£åº¦çŸ©é˜µ
$$
\mathbf{S}_b=\left(\boldsymbol{\mu}_0-\boldsymbol{\mu}_1\right)\left(\boldsymbol{\mu}_0-\boldsymbol{\mu}_1\right)^\mathrm{T}
$$
**LDA çš„ç›®æ ‡ï¼šæœ€å¤§åŒ–å¹¿ä¹‰ç‘åˆ©å•†**ï¼š$\boxed{J=\frac{\boldsymbol{w}^\mathrm{T}\mathrm{S}_b\boldsymbol{w}}{\boldsymbol{w}^\mathrm{T}\mathrm{S}_w\boldsymbol{w}}}$ï¼Œå…¶ä¸­ w æˆå€ç¼©æ”¾ä¸å½±å“ J å€¼ï¼Œä»…è€ƒè™‘æ–¹å‘

**æ±‚è§£æ€è·¯**ï¼š

ä»¤ $w^\mathrm{T}\mathbf{S}_w\boldsymbol{w}=1$ï¼Œæœ€å¤§åŒ–å¹¿ä¹‰ç‘åˆ©å•†ç­‰ä»·å½¢å¼ä¸º $\min_w-w^\mathrm{T}\mathrm{S}_bw$ï¼Œ$\mathrm{s.t.~}w^\mathrm{T}\mathbf{S}_w\boldsymbol{w}=1$

è¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼Œæœ‰ $\mathbf{S}_bw=\lambda\mathbf{S}_w\boldsymbol{w}$

ç”± $\mathbf{S}_b=\left(\boldsymbol{\mu}_0-\boldsymbol{\mu}_1\right)\left(\boldsymbol{\mu}_0-\boldsymbol{\mu}_1\right)^\mathrm{T}$ æœ‰ $\mathbf{S} _b\boldsymbol{w}= \left ( \boldsymbol{\mu }_0- \boldsymbol{\mu }_1\right ) \left ( \boldsymbol{\mu }_0- \boldsymbol{\mu }_1\right ) ^\mathrm{T} \boldsymbol{w}$

æ³¨æ„åˆ° $(\mu_0-\boldsymbol{\mu}_1)^\mathrm{T}\boldsymbol{w}$ æ˜¯æ ‡é‡ï¼Œä»¤å…¶ç­‰äº $\lambda$

äºæ˜¯ $\boldsymbol{w}= \mathbf{S} _w^{- 1}\left ( \boldsymbol{\mu }_0- \boldsymbol{\mu }_1\right )$

å®è·µä¸­é€šå¸¸æ˜¯è¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£ $\mathbf{S}_w=\mathbf{U\Sigma V}^\mathrm{T}$ï¼Œç„¶å $\mathbf{S} _w^{- 1}= \mathbf{V} \mathbf{\Sigma } ^{- 1}\mathbf{U} ^\mathrm{T}$

**æ¨å¹¿åˆ°å¤šç±»**ï¼š

å‡å®šæœ‰ N ä¸ªç±»

- å…¨å±€æ•£åº¦çŸ©é˜µï¼š

$$
\mathbf{S}_t=\mathbf{S}_b+\mathbf{S}_w=\sum_{i=1}^m\left(\boldsymbol{x}_i-\boldsymbol{\mu}\right)\left(\boldsymbol{x}_i-\boldsymbol{\mu}\right)^T
$$

- ç±»å†…æ•£åº¦çŸ©é˜µï¼š

$$
\mathbf{S}_w=\sum_{i=1}^N\mathbf{S}_{w_i}
\\
\mathbf{S}_{w_i}=\sum_{x\in X_i}\left(\boldsymbol{x}\boldsymbol{\mu}_i\right)\left(\boldsymbol{x}-\boldsymbol{\mu}_i\right)^T
$$

- ç±»é—´æ•£åº¦çŸ©é˜µï¼š

$$
\mathbf{S}_b=\mathbf{S}_t-\mathbf{S}_w=\sum_{i=1}^Nm_i\left(\boldsymbol{\mu}_i-\boldsymbol{\mu}\right)\left(\boldsymbol{\mu}_i-\boldsymbol{\mu}\right)^T
$$

å¤šåˆ†ç±» LDA æœ‰å¤šç§å®ç°æ–¹æ³•ï¼šé‡‡ç”¨ $\mathbf{S}_b$ï¼Œ$\mathbf{S}_w$ï¼Œ$\mathbf{S}_t$ ä¸­çš„ä»»ä½•ä¸¤ä¸ª

ä¼˜åŒ–ç›®æ ‡ï¼š$\max_{\mathbf{W}}\frac{\mathrm{tr}\left(\mathbf{W}^\mathrm{T}\mathbf{S}_b\mathbf{W}\right)}{\mathrm{tr}\left(\mathbf{W}^\mathrm{T}\mathbf{S}_w\mathbf{W}\right)} \Rightarrow \mathbf{S}_b\mathbf{W}=\lambda\mathbf{S}_w\mathbf{W}$

W çš„é—­å¼è§£æ˜¯ $S_w^{-1}\mathrm{S}_b$ çš„ $d^\prime(\leq N-1)$ ä¸ªæœ€å¤§éé›¶å¹¿ä¹‰ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ç»„æˆçš„çŸ©é˜µ

å¤šåˆ†ç±» LDA å°†æ ·æœ¬æŠ•å½±åˆ° dâ€² ç»´ç©ºé—´ï¼Œ dâ€² é€šå¸¸è¿œå°äºæ•°æ®åŸæœ‰çš„å±æ€§æ•° dï¼Œå› æ­¤ LDA ä¹Ÿè¢«è§†ä¸ºä¸€ç§ç›‘ç£é™ç»´æŠ€æœ¯

## 3.5 å¤šåˆ†ç±»å­¦ä¹ 

åˆ©ç”¨äºŒåˆ†ç±»å­¦ä¹ å™¨è§£å†³å¤šåˆ†ç±»é—®é¢˜

- å¯¹é—®é¢˜è¿›è¡Œæ‹†åˆ†ï¼Œä¸ºæ‹†å‡ºçš„æ¯ä¸ªäºŒåˆ†ç±»ä»»åŠ¡è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨
- å¯¹äºæ¯ä¸ªåˆ†ç±»å™¨çš„é¢„æµ‹ç»“æœè¿›è¡Œé›†æˆä»¥è·å¾—æœ€ç»ˆçš„å¤šåˆ†ç±»ç»“æœ

æ‹†åˆ†ç­–ç•¥ï¼šä¸€å¯¹ä¸€ï¼ˆOvOï¼‰ï¼›ä¸€å¯¹å…¶ä½™ï¼ˆOvRï¼‰ï¼›å¤šå¯¹å¤šï¼ˆMvMï¼‰

### ä¸€å¯¹ä¸€ï¼ˆOvOï¼‰

ç»™å®šæ•°æ®é›† $D=\{(\boldsymbol{x}_1,y_1),(\boldsymbol{x}_2,y_2),\ldots,(\boldsymbol{x}_m,y_m)\}$ï¼Œ$y_i\in\{C_1,C_2,\ldots,C_N\}$

- æ‹†åˆ†é˜¶æ®µï¼šOvO å°†è¿™ N ä¸ªç±»åˆ«ä¸¤ä¸¤é…å¯¹ï¼Œäº§ç”Ÿ N(N-1)/2 ä¸ªäºŒç±»ä»»åŠ¡ï¼Œå³æœ‰ N(N-1)/2 ä¸ªäºŒç±»ä»»åŠ¡å­¦ä¹ åˆ†ç±»å™¨

- æµ‹è¯•é˜¶æ®µï¼šæ–°æ ·æœ¬æäº¤ç»™æ‰€æœ‰åˆ†ç±»å™¨é¢„æµ‹ï¼Œäº§ç”Ÿ N(N-1)/2 ä¸ªåˆ†ç±»ç»“æœï¼ŒæŠ•ç¥¨äº§ç”Ÿæœ€ç»ˆåˆ†ç±»ç»“æœï¼Œè¢«é¢„æµ‹æœ€å¤šçš„ç±»åˆ«ä¸ºæœ€ç»ˆç±»åˆ«

### ä¸€å¯¹å…¶ä½™ï¼ˆOvRï¼‰

- æ‹†åˆ†é˜¶æ®µï¼šæ¯æ¬¡å°†ä¸€ä¸ªç±»çš„æ ·ä¾‹ä½œä¸ºæ­£ä¾‹ã€æ‰€æœ‰å…¶ä»–ç±»çš„æ ·ä¾‹ä½œä¸ºåä¾‹æ¥è®­ç»ƒ N ä¸ªåˆ†ç±»å™¨

- æµ‹è¯•é˜¶æ®µï¼šæ–°æ ·æœ¬æäº¤ç»™æ‰€æœ‰åˆ†ç±»å™¨é¢„æµ‹ï¼ŒN ä¸ªåˆ†ç±»ç»“æœï¼Œæ¯”è¾ƒå„åˆ†ç±»å™¨é¢„æµ‹ç½®ä¿¡åº¦ï¼Œç½®ä¿¡åº¦æœ€å¤§çš„ç±»åˆ«ä½œä¸ºæœ€ç»ˆç±»åˆ«

OvO è®­ç»ƒ N(N-1)/2 ä¸ªåˆ†ç±»å™¨ï¼Œå­˜å‚¨å¼€é”€å’Œæµ‹è¯•æ—¶é—´å¤§ï¼›OvR è®­ç»ƒ N ä¸ªåˆ†ç±»å™¨ï¼Œå­˜å‚¨å¼€é”€å’Œæµ‹è¯•æ—¶é—´å°
OvO è®­ç»ƒåªç”¨ä¸¤ä¸ªç±»çš„æ ·ä¾‹ï¼Œè®­ç»ƒæ—¶é—´çŸ­ï¼›OvR è®­ç»ƒç”¨åˆ°å…¨éƒ¨è®­ç»ƒæ ·ä¾‹ï¼Œè®­ç»ƒæ—¶é—´é•¿

é¢„æµ‹æ€§èƒ½å–å†³äºå…·ä½“æ•°æ®åˆ†å¸ƒï¼Œå¤šæ•°æƒ…å†µä¸‹ä¸¤è€…å·®ä¸å¤š

### å¤šå¯¹å¤šï¼ˆMvMï¼‰

æ¯æ¬¡æ¬¡å°†è‹¥å¹²ä¸ªç±»ä½œä¸ºæ­£ç±»ï¼Œè‹¥å¹²ä¸ªå…¶ä»–ç±»ä½œä¸ºåç±»

å¸¸è§æ–¹æ³•ï¼šçº é”™è¾“å‡ºç ï¼ˆECOCï¼‰

ç¼–ç ï¼šå¯¹ N ä¸ªç±»åˆ«åš M æ¬¡åˆ’åˆ†ï¼Œæ¯æ¬¡åˆ’åˆ†å°†ä¸€éƒ¨åˆ†ç±»åˆ«åˆ’ä¸ºæ­£ç±»ï¼Œä¸€éƒ¨åˆ†åˆ’ä¸ºåç±»ï¼Œä»è€Œå½¢æˆä¸€ä¸ªäºŒåˆ†ç±»è®­ç»ƒé›†ï¼›è¿™æ ·ä¸€å…±äº§ç”Ÿ M ä¸ªè®­ç»ƒé›†ï¼Œå¯è®­ç»ƒå‡º M ä¸ªåˆ†ç±»å™¨

è§£ç ï¼šM ä¸ªåˆ†ç±»å™¨åˆ†åˆ«å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼Œè¿™äº›é¢„æµ‹æ ‡è®°ç»„æˆä¸€ä¸ªç¼–ç ã€‚å°†è¿™ä¸ªé¢„æµ‹ç¼–ç ä¸æ¯ä¸ªç±»åˆ«å„è‡ªçš„ç¼–ç è¿›è¡Œæ¯”è¾ƒï¼Œè¿”å›å…¶ä¸­è·ç¦»æœ€å°çš„ç±»åˆ«ä½œä¸ºæœ€ç»ˆé¢„æµ‹ç»“æœ

ECOC ç¼–ç å¯¹åˆ†ç±»å™¨é”™è¯¯æœ‰ä¸€å®šå®¹å¿å’Œä¿®æ­£èƒ½åŠ›ï¼Œç¼–ç è¶Šé•¿ã€çº é”™èƒ½åŠ›è¶Šå¼º

å¯¹åŒç­‰é•¿åº¦çš„ç¼–ç ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œä»»æ„ä¸¤ä¸ªç±»åˆ«ä¹‹é—´çš„ç¼–ç è·ç¦»è¶Šè¿œï¼Œåˆ™çº é”™èƒ½åŠ›è¶Šå¼º

## 3.6 ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜

**ç±»åˆ«ä¸å¹³è¡¡**æŒ‡åˆ†ç±»ä»»åŠ¡ä¸­ä¸åŒç±»åˆ«çš„è®­ç»ƒæ ·ä¾‹æ•°ç›®å·®åˆ«å¾ˆå¤§çš„æƒ…å†µ

åŸºæœ¬æ€è·¯ï¼š 

è‹¥ $\frac{y}{1-y} >1$ åˆ™é¢„æµ‹ä¸ºæ­£ä¾‹ $\Rightarrow$ è‹¥ $\frac{y}{1-y} > \frac{m^+}{m^-}$ åˆ™é¢„æµ‹ä¸ºæ­£ä¾‹

åŸºæœ¬ç­–ç•¥ï¼šå†ç¼©æ”¾ $\frac{y^{\prime}}{1-y^{\prime}}=\frac{y}{1-y}\times\frac{m^-}{m^+}$

ç„¶è€Œï¼Œç²¾ç¡®ä¼°è®¡ m-/m+ é€šå¸¸å¾ˆå›°éš¾

å¸¸è§ç±»åˆ«ä¸å¹³è¡¡å­¦ä¹ æ–¹æ³•ï¼š

- è¿‡é‡‡æ ·ï¼šå¢åŠ ä¸€äº›æ­£ä¾‹ä½¿æ­£åä¾‹æ•°ç›®æ¥è¿‘ï¼ˆSMOTEï¼‰
- æ¬ é‡‡æ ·ï¼šå»é™¤ä¸€äº›åä¾‹ä½¿æ­£åä¾‹æ•°ç›®æ¥è¿‘ï¼ˆEasyEnsembleï¼‰
- é˜ˆå€¼ç§»åŠ¨



å„ä»»åŠ¡ä¸‹ï¼ˆå›å½’ã€åˆ†ç±»ï¼‰å„ä¸ªæ¨¡å‹ä¼˜åŒ–çš„ç›®æ ‡

- æœ€å°äºŒä¹˜æ³•ï¼šæœ€å°åŒ–å‡æ–¹è¯¯å·®
- å¯¹æ•°å‡ ç‡å›å½’ï¼šæœ€å¤§åŒ–æ ·æœ¬åˆ†å¸ƒä¼¼ç„¶
- çº¿æ€§åˆ¤åˆ«åˆ†æï¼šæŠ•å½±ç©ºé—´å†…æœ€å°ï¼ˆå¤§ï¼‰åŒ–ç±»å†…ï¼ˆé—´ï¼‰æ•£åº¦

å‚æ•°çš„ä¼˜åŒ–æ–¹æ³•

- æœ€å°äºŒä¹˜æ³•ï¼šçº¿æ€§ä»£æ•°
- å¯¹æ•°å‡ ç‡å›å½’ï¼šå‡¸ä¼˜åŒ–æ¢¯åº¦ä¸‹é™ã€ç‰›é¡¿æ³•
- çº¿æ€§åˆ¤åˆ«åˆ†æï¼šçŸ©é˜µè®ºã€å¹¿ä¹‰ç‘åˆ©å•†

